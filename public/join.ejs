<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <title>CodesEra</title>
  </head>

  <body class="font-body overflow-hidden">
    <header>
      <div class="text-white p-8 pt-6 flex flex-row justify-between">
        <div class="font-bold text-2xl">CODES<span class="text-blue-400">ERA</span></div>  
        <a href="/logout" class="text-sm text-red-400">Logout</a>
      </div>
    </header>
    <!-- Main Content -->
    <section>
      <div class="flex flex-col items-center py-8 px-4 mx-auto max-w-screen-xl text-center lg:p-12">
          <h1 class="mb-4 text-4xl font-extrabold tracking-tight md:text-5xl lg:text-7xl text-white"></h1>
          <div class="flex flex-row mb-8 lg:mb-16 space-y-4 sm:flex-row sm:justify-center sm:space-y-0 sm:space-x-4 sm:px-8">
              
            <div class="mb-12 md:mb-0 text-center">
              <div class="mb-6 flex justify-center">
                <img
                  src=" <%= userImg %> "
                  class="w-32 rounded-full shadow-lg dark:shadow-black/30" 
                  referrerpolicy="no-referrer"/>
              </div>
              <h5 class="mb-4 text-2xl font-semibold text-white"> <%= userData.name %> </h5>  
            </div>            
          </div>
          <div>
            <form action="/workspace" id="join-room" method="POST">
              <div class="form-group mb-8 mt-4">
                <input name="room" placeholder="Enter Room ID" type="text" id="room-id" value="<%= roomId || '' || '' %>" class="w-96 px-3 py-1.5 text-base font-normal text-white bg-transparent bg-clip-padding border border-solid border-blue-400 rounded transition ease-in-out m-0 focus:text-white focus:border-blue-600 focus:outline-none" id="room" required>
              </div>
              
              <div class="w-full text-center">
                <button type="submit" id="join-btn" class="mx-auto px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">JOIN</button>
              </div>
  
              <p class="text-white mt-6 text-center text-sm">Don't have Room ID? &ensp;
                <a href="javascript:void(0)" class="text-blue-400 hover:text-blue-500 focus:text-blue-500 transition duration-200 ease-in-out" id="gen-room">Create a new room</a>
              </p>
            </form>
          </div>    
      </div>
  </section>
  </body>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.11.0/qs.min.js" integrity="sha512-/l6vieC+YxaZywUhmqs++8uF9DeMvJE61ua5g+UK0TuHZ4TkTgB1Gm1n0NiA86uEOM9JJ6JUwyR0hboKO0fCng==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    function generateRoomCode() {
      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      var code = '';
      
      for (var i = 0; i < 4; i++) {
        code += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      code += '-';
      
      for (var i = 0; i < 4; i++) {
        code += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      
      return code;
    }

    const roomField = document.getElementById('room-id');
    const genBtn = document.getElementById('gen-room');

    genBtn.addEventListener("click", () => {
      var randomCode = generateRoomCode();
      roomField.value = randomCode;

      window.location.href = '/join/' + randomCode;
    });
  </script>
</html>